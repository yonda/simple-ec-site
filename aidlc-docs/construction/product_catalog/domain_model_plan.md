# 商品カタログドメインモデル設計計画

## 目的
商品カタログユニットのユーザーストーリー(US-001〜US-004)を実装するためのドメインモデルを設計する。

## 作業ステップ

### ステップ1: ドメインエンティティの特定
- [ ] ユーザーストーリーから必要なエンティティを洗い出す
- [ ] 各エンティティの責務を明確化する
- [ ] エンティティの識別子を定義する

[Question] 商品カタログで扱う「書籍」について、以下の点を明確にしてください:
1. 書籍のカテゴリ(ジャンル)は固定のリストですか、それとも動的に管理されますか?
2. ISBNは必須項目ですか?
3. 書籍の画像は複数枚対応する必要がありますか?

[Answer]


### ステップ2: 値オブジェクトの特定
- [ ] ユーザーストーリーから値オブジェクトの候補を洗い出す
- [ ] 各値オブジェクトのバリデーションルールを定義する
- [ ] 値オブジェクト間の関係を整理する

[Question] 価格について以下の点を明確にしてください:
1. 税込み価格と税抜き価格の両方を管理しますか?
2. 価格の通貨は日本円のみですか?
3. 価格は変更される可能性がありますか(セールやキャンペーン)?

[Answer]


### ステップ3: ドメインサービスの特定
- [ ] エンティティや値オブジェクトに属さないビジネスロジックを特定する
- [ ] 検索機能の仕様を設計する
- [ ] フィルタリング機能の仕様を設計する

[Question] 検索とフィルタリングについて以下の点を明確にしてください:
1. 検索はどの程度の精度が必要ですか(完全一致、前方一致、部分一致、あいまい検索)?
2. フィルタと検索は同時に使用可能ですか?
3. 検索結果のソート順序は何ですか(関連度、価格、新着順など)?

[Answer]


### ステップ4: リポジトリインターフェースの設計
- [ ] エンティティの永続化に必要なリポジトリを定義する
- [ ] 各リポジトリのメソッドを定義する
- [ ] クエリ仕様を明確化する

[Question] データの取得について以下の点を明確にしてください:
1. 商品一覧のページネーション方式は何ですか(オフセット、カーソル、無限スクロール)?
2. 1ページあたりの表示件数は固定ですか、ユーザーが変更可能ですか?
3. 商品一覧のデフォルトのソート順序は何ですか?

[Answer]


### ステップ5: 外部ユニットとの統合ポイントの定義
- [ ] 在庫管理ユニットとの連携方法を定義する
- [ ] 在庫情報の取得タイミングを決定する
- [ ] データの整合性を保つ方法を検討する

[Question] 在庫管理ユニットとの連携について以下の点を明確にしてください:
1. 在庫情報はリアルタイムで取得しますか、それともキャッシュしますか?
2. 在庫数は正確な数値を表示しますか、それとも「在庫あり/なし」の2値ですか?
3. 在庫管理ユニットとの通信が失敗した場合の振る舞いはどうしますか?

[Answer]


### ステップ6: ドメインイベントの特定
- [ ] ユーザーストーリーで発生するビジネスイベントを洗い出す
- [ ] 各イベントのペイロードを定義する
- [ ] イベントのトリガー条件を明確化する

[Question] ドメインイベントについて以下の点を明確にしてください:
1. 商品が閲覧された際にイベントを発行する必要がありますか(アクセスログ、レコメンデーション用)?
2. 検索やフィルタリングの実行をイベントとして記録しますか?

[Answer]


### ステップ7: ドメインモデルの文書化
- [ ] エンティティの詳細をドキュメント化する
- [ ] 値オブジェクトの詳細をドキュメント化する
- [ ] ドメインサービスの詳細をドキュメント化する
- [ ] リポジトリの詳細をドキュメント化する
- [ ] コンポーネント間の相互作用図を作成する

### ステップ8: レビューと調整
- [ ] ドメインモデル全体の整合性を確認する
- [ ] ユーザーストーリーの受け入れ基準がすべて満たせることを確認する
- [ ] 過剰設計や不足がないかチェックする

## 成果物
以下のファイルを `aidlc-docs/construction/product_catalog/` フォルダに作成します:

1. `entities.md` - エンティティの定義
2. `value_objects.md` - 値オブジェクトの定義
3. `domain_services.md` - ドメインサービスの定義
4. `repositories.md` - リポジトリインターフェースの定義
5. `external_integrations.md` - 外部ユニットとの統合の定義
6. `domain_events.md` - ドメインイベントの定義
7. `interactions.md` - コンポーネント間の相互作用

## 注意事項
- アーキテクチャコンポーネント(コントローラ、API、UIなど)は含めない
- 実装コードは生成しない
- 純粋なドメインロジックのみに焦点を当てる
- ビジネスルールとビジネス用語を使用する
