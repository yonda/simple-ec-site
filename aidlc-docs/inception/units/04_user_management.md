# ユニット4: ユーザー管理 (User Management)

## 概要
ユーザーアカウントの管理と認証、注文履歴の閲覧機能を提供する境界づけられたコンテキスト。
登録済みユーザーの体験を担当する。

## 責任範囲
- ユーザー登録
- ログイン・ログアウト
- ユーザー情報の管理
- 注文履歴の表示
- 認証状態の管理

## ユニット間インターフェース
**依存するユニット:**
- 注文・決済管理ユニット（注文履歴表示用）

**提供するAPI:**
- ユーザー登録
- ログイン
- ログアウト
- 注文履歴取得
- ユーザー情報取得

---

## ユーザーストーリー

### US-012: ユーザー登録

**ストーリー**
> ゲストユーザーとして、アカウントを作成したい。なぜなら、注文履歴を確認したいため。

**受け入れ基準**
- [ ] ユーザー登録ページが表示される
- [ ] メールアドレス、パスワード、氏名、郵便番号、住所、電話番号を入力できる
- [ ] パスワードは8文字以上必要
- [ ] メールアドレスは有効な形式である必要がある
- [ ] 登録ボタンをクリックすると、アカウントが作成される
- [ ] 既に登録済みのメールアドレスの場合、エラーメッセージが表示される
- [ ] 登録成功後、自動的にログインされる

**優先度**: 高（MVP）

---

### US-013: ログイン

**ストーリー**
> 登録済みユーザーとして、ログインしたい。なぜなら、注文履歴を確認したいため。

**受け入れ基準**
- [ ] ログインページが表示される
- [ ] メールアドレスとパスワードを入力できる
- [ ] ログインボタンをクリックすると、認証が行われる
- [ ] 認証成功時、トップページに遷移する
- [ ] 認証失敗時、「メールアドレスまたはパスワードが正しくありません」と表示される
- [ ] ログイン後、ヘッダーに「マイページ」リンクが表示される

**優先度**: 高（MVP）

---

### US-014: ログアウト

**ストーリー**
> 登録済みユーザーとして、ログアウトしたい。なぜなら、セキュリティを保ちたいため。

**受け入れ基準**
- [ ] ログイン後、ヘッダーに「ログアウト」ボタンが表示される
- [ ] ログアウトボタンをクリックすると、ログアウトされる
- [ ] ログアウト後、トップページに遷移する
- [ ] ログアウト後、「マイページ」リンクは非表示になる

**優先度**: 高（MVP）

---

### US-015: 注文履歴一覧表示

**ストーリー**
> 登録済みユーザーとして、過去の注文履歴を閲覧したい。なぜなら、何を購入したか確認したいため。

**受け入れ基準**
- [ ] マイページに「注文履歴」リンクが表示される
- [ ] 注文履歴ページに、過去の注文一覧が表示される
- [ ] 各注文について、注文番号、注文日時、合計金額、注文状態が表示される
- [ ] 注文は新しい順に表示される
- [ ] 注文がない場合、「注文履歴はありません」と表示される
- [ ] ゲストユーザーの場合、この機能は利用できない

**優先度**: 高（MVP）

---

### US-016: 注文詳細表示

**ストーリー**
> 登録済みユーザーとして、注文の詳細を閲覧したい。なぜなら、特定の注文内容を確認したいため。

**受け入れ基準**
- [ ] 注文履歴一覧から注文をクリックすると、注文詳細ページに遷移する
- [ ] 注文番号、注文日時、配送先住所が表示される
- [ ] 注文した書籍の一覧（書籍画像、タイトル、価格、数量、小計）が表示される
- [ ] 合計金額が表示される
- [ ] 「注文履歴に戻る」ボタンが表示される

**優先度**: 高（MVP）

---

## ユニット内の依存関係
- US-012（ユーザー登録）とUS-013（ログイン）が基礎
- US-014（ログアウト）はUS-013に依存
- US-015（注文履歴一覧）はUS-013に依存
- US-016（注文詳細）はUS-015に依存
- US-012、US-013、US-014は認証機能として並行実装可能
- US-015とUS-016は注文履歴機能として一緒に実装可能
